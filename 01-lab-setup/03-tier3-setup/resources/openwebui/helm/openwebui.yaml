
ollama:
  enabled: false

pipelines:
  enabled: false

websocket:
  enabled: false

redis:
  enabled: false

enableOpenaiApi: true
openaiBaseApiUrl: "https://llmd.internal.k8s.local/v1"
openaiApiKey: ""

volumes:
  - name: trusted-ca
    secret:
      secretName: k8s-lab-ca-secret
      items:
        - key: cert.pem     # la cl√© dans le Secret
          path: ca-bundle.pem

volumeMounts:
  container:
    - name: trusted-ca
      mountPath: /etc/openwebui-trust
      readOnly: true

extraEnvVars:
  - name: WEBUI_URL
    value: "https://open-webui.lab.k8s.local"

  - name: WEBUI_SECRET_KEY
    valueFrom:
      secretKeyRef:
        name: openwebui-secret-key
        key: webui-secret-key

  - name: OPENAI_API_KEY
    valueFrom:
      secretKeyRef:
        name: vllm-api-key
        key: api-key

  - name: ENABLE_LOGIN_FORM
    value: "false"

  - name: ENABLE_SIGNUP
    value: "false"

  - name: ENABLE_OAUTH_SIGNUP
    value: "true"

  - name: OAUTH_CODE_CHALLENGE_METHOD
    value: "S256"

  - name: ADMIN_EMAIL
    value: "admin1@lab.k8s.local"

  - name: SSL_CERT_FILE
    value: /etc/openwebui-trust/ca-bundle.pem

  - name: REQUESTS_CA_BUNDLE
    value: /etc/openwebui-trust/ca-bundle.pem

sso:
  enabled: true
  enableSignup: false
  mergeAccountsByEmail: false
  enableRoleManagement: true
  enableGroupManagement: true

  oidc:
    enabled: true
    clientId: "open-webui"
    clientExistingSecret: "oidc"
    clientExistingSecretKey: "client-secret"
    providerUrl: "https://keycloak.auth.k8s.local/realms/k8s-lab/.well-known/openid-configuration"
    providerName: "Keycloak"
    scopes: "openid email profile"

  roleManagement:
    rolesClaim: "groups"
    allowedRoles: "USERS"
    adminRoles: "ADMINS"

  groupManagement:
    groupsClaim: "groups"

startupProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  failureThreshold: 120

readinessProbe:
  httpGet:
    path: /health
    port: http
  periodSeconds: 30
  failureThreshold: 3

